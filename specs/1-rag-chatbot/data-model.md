# Data Model: RAG Chatbot for Physical AI & Humanoid Robotics Textbook

## Entity: StudentSession
**Description**: Represents a user's interaction session with the chatbot, including conversation history and context

**Fields**:
- `id`: UUID (Primary Key) - Unique identifier for the session
- `created_at`: DateTime - Timestamp when the session was created
- `last_activity`: DateTime - Timestamp of the last activity in the session
- `mode`: String enum('full_book', 'selected_text') - Current mode of operation
- `metadata`: JSON - Additional session metadata (user agent, etc.)

**Validation**:
- `id` must be a valid UUID
- `created_at` must be in the past
- `mode` must be one of the allowed values

## Entity: Question
**Description**: A query submitted by the student to the chatbot

**Fields**:
- `id`: UUID (Primary Key) - Unique identifier for the question
- `session_id`: UUID (Foreign Key to StudentSession) - Reference to the parent session
- `content`: Text - The actual question text
- `created_at`: DateTime - Timestamp when the question was submitted
- `selected_text`: Text (nullable) - Text selected by user for "selected text only" mode
- `context_mode`: String enum('full_book', 'selected_text') - Mode used for this question

**Validation**:
- `id` must be a valid UUID
- `session_id` must reference an existing session
- `content` must not be empty
- `context_mode` must match the session's current mode or be explicitly set

## Entity: Answer
**Description**: The response generated by the RAG system based on textbook content

**Fields**:
- `id`: UUID (Primary Key) - Unique identifier for the answer
- `question_id`: UUID (Foreign Key to Question) - Reference to the corresponding question
- `content`: Text - The answer content
- `sources`: JSON array - List of source references used to generate the answer
- `created_at`: DateTime - Timestamp when the answer was generated
- `confidence_score`: Float (0.0-1.0) - Confidence level of the response

**Validation**:
- `id` must be a valid UUID
- `question_id` must reference an existing question
- `content` must not be empty
- `confidence_score` must be between 0.0 and 1.0

## Entity: TextbookContent
**Description**: The "Physical AI & Humanoid Robotics" textbook data that serves as the knowledge base

**Fields**:
- `id`: UUID (Primary Key) - Unique identifier for the content chunk
- `section`: String - The section identifier (e.g., "Chapter 3.2")
- `content`: Text - The actual textbook content
- `embedding`: Vector - Vector embedding of the content for similarity search
- `metadata`: JSON - Additional metadata (page numbers, headings, etc.)
- `created_at`: DateTime - Timestamp when the content was indexed

**Validation**:
- `id` must be a valid UUID
- `content` must not be empty
- `embedding` must be a valid vector of the expected dimension

## Relationships

```
StudentSession (1) ←→ (N) Question
Question (1) ←→ (1) Answer
TextbookContent (N) → (N) Answer (through source references)
```

## State Transitions

### StudentSession
- **Created**: When a new session is initiated
- **Active**: When questions are being asked in the session
- **Expired**: When the session has been inactive beyond the timeout period

### Question/Answer Pair
- **Pending**: When a question is submitted but not yet processed
- **Processing**: When the RAG system is retrieving and generating the answer
- **Completed**: When the answer is generated and returned to the user